<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
<title>BTCUSDT · BACKEND SIGNAL MODE (GALAK)</title>

<style>
*{box-sizing:border-box}
body{margin:0;background:#000;color:#0f0;font-family:Courier New,monospace;overflow:hidden}

#header{
  padding:8px;
  text-align:center;
  font-weight:900;
  background:#000;
  border-bottom:2px solid #00ff66;
  color:#00ff66;
}

#status{
  position:fixed;
  top:42px;
  left:0;
  right:0;
  padding:14px;
  text-align:center;
  font-weight:900;
  font-size:16px;
  display:none;
  z-index:9999;
}

.chart{
  height:45vh;
  border-bottom:1px solid #222;
}

.footer{
  padding:6px;
  font-size:10px;
  color:#777;
  text-align:center;
  background:#000;
}
</style>
</head>

<body>

<div id="header">BTCUSDT · BACKEND SIGNAL MODE (GALAK)</div>
<div id="status"></div>

<div class="chart">
  <iframe
    src="https://s.tradingview.com/widgetembed/?symbol=BINANCE:BTCUSDT&interval=1&theme=dark&style=1"
    style="width:100%;height:100%;border:0;"
    allowfullscreen>
  </iframe>
</div>

<div class="chart">
  <iframe
    src="https://s.tradingview.com/widgetembed/?symbol=BINANCE:BTCUSDT&interval=5&theme=dark&style=1"
    style="width:100%;height:100%;border:0;"
    allowfullscreen>
  </iframe>
</div>

<div class="footer">
  Backend memutuskan KONDISI · Entry tetap keputusan trader
</div>

<script>
// ================== GANTI URL WORKER ==================
const WS_URL = "wss://btusdmt5.sapammeded.workers.dev";
// ======================================================

const box = document.getElementById("status");
let ws, retry = 0;

function show(msg, color){
  box.innerText = msg;
  box.style.background = color;
  box.style.color = "#000";
  box.style.display = "block";
}

function connect(){
  ws = new WebSocket(WS_URL);

  ws.onopen = () => {
    retry = 0;
    show("⏳ BACKEND CONNECTED – MENUNGGU KEPUTUSAN...", "#777");
  };

  ws.onmessage = e => {
    try{
      const d = JSON.parse(e.data);
      if(d.status === "WAIT")     show(d.message, "#ffea00");
      if(d.status === "READY")    show(d.message, "#00ff99");
      if(d.status === "NO_TRADE") show(d.message, "#ff4444");
    }catch(err){}
  };

  ws.onerror = () => ws.close();

  ws.onclose = () => {
    retry++;
    show("❌ BACKEND DISCONNECTED – RECONNECTING...", "#ff4444");
    setTimeout(connect, Math.min(5000, retry * 1000));
  };
}

connect();
</script>

</body>
</html>
